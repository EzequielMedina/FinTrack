<div class="transactions-container">
  <!-- Header -->
  <div class="page-header">
    <h1>Transacciones</h1>
  </div>

  <!-- Filters Panel -->
  <div class="filters-panel">
    <div class="filters-grid">
      <div class="filter-group">
        <label for="typeFilter">Tipo</label>
        <select 
          id="typeFilter" 
          [(ngModel)]="filters.type" 
          (ngModelChange)="onFilterChange()"
          class="form-control">
          <option value="">Todos</option>
          <option value="wallet_deposit">Depósito</option>
          <option value="wallet_withdrawal">Retiro</option>
          <option value="wallet_transfer">Transferencia</option>
          <option value="account_deposit">Depósito en Cuenta</option>
          <option value="account_withdraw">Retiro de Cuenta</option>
          <option value="account_transfer">Transferencia entre Cuentas</option>
          <option value="credit_payment">Pago de Tarjeta</option>
          <option value="credit_charge">Cargo de Crédito</option>
          <option value="debit_purchase">Compra con Débito</option>
          <option value="installment_payment">Pago de Cuota</option>
          <option value="salary">Salario</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="startDate">Desde</label>
        <input 
          type="date" 
          id="startDate"
          [(ngModel)]="filters.startDate" 
          (ngModelChange)="onFilterChange()"
          class="form-control">
      </div>

      <div class="filter-group">
        <label for="endDate">Hasta</label>
        <input 
          type="date" 
          id="endDate"
          [(ngModel)]="filters.endDate" 
          (ngModelChange)="onFilterChange()"
          class="form-control">
      </div>

      <div class="filter-group">
        <label for="minAmount">Monto Mínimo</label>
        <input 
          type="number" 
          id="minAmount"
          [(ngModel)]="filters.minAmount" 
          (ngModelChange)="onFilterChange()"
          step="0.01"
          class="form-control">
      </div>

      <div class="filter-group">
        <label for="maxAmount">Monto Máximo</label>
        <input 
          type="number" 
          id="maxAmount"
          [(ngModel)]="filters.maxAmount" 
          (ngModelChange)="onFilterChange()"
          step="0.01"
          class="form-control">
      </div>

      <div class="filter-actions">
        <button 
          type="button" 
          class="btn btn-secondary btn-sm"
          (click)="clearFilters()">
          Limpiar
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="content-container">
    
    <!-- LISTA DE TRANSACCIONES -->
    <div class="transactions-list">
      <div *ngIf="loading" class="loading-container">
        <div class="spinner"></div>
        <p>Cargando transacciones...</p>
      </div>

      <div *ngIf="!loading && transactions.length === 0" class="empty-state">
        <div class="empty-icon">
          <i class="icon-receipt"></i>
        </div>
        <h3>No hay transacciones</h3>
        <p>Aún no tienes transacciones registradas.</p>
      </div>

      <div *ngIf="!loading && transactions.length > 0" class="transactions-grid">
        <div 
          *ngFor="let transaction of transactions" 
          class="transaction-card"
          [class]="getStatusClass(transaction.status)">
          
          <div class="transaction-icon" [ngClass]="'transaction-' + transaction.type.toLowerCase()">
            <mat-icon>{{ getTransactionIcon(transaction.type) }}</mat-icon>
          </div>

          <div class="transaction-content">
            <div class="transaction-header">
              <h4>{{ getTransactionTypeLabel(transaction.type) }}</h4>
              <span class="transaction-amount" 
                    [class.positive]="transaction.type === TransactionType.DEPOSIT || transaction.type === TransactionType.REFUND"
                    [class.negative]="transaction.type === TransactionType.WITHDRAWAL || transaction.type === TransactionType.PAYMENT">
                {{ transaction.amount | currency:transaction.currency }}
              </span>
            </div>

            <div class="transaction-details">
              <p *ngIf="transaction.description" class="description">
                {{ transaction.description }}
              </p>
              
              <div class="transaction-accounts" *ngIf="transaction.fromAccountId || transaction.toAccountId">
                <span *ngIf="transaction.fromAccountId" class="from-account">
                  {{ getAccountName(transaction.fromAccountId) }}
                </span>
                <span *ngIf="transaction.toAccountId" class="to-account">
                  → {{ getAccountName(transaction.toAccountId) }}
                </span>
              </div>

              <div class="transaction-meta">
                <span class="transaction-date">
                  {{ transaction.createdAt | date:'short' }}
                </span>
                <span class="transaction-status" [class]="'status-' + transaction.status.toLowerCase()">
                  {{ transaction.status | titlecase }}
                </span>
              </div>
            </div>
          </div>

          <div class="transaction-actions">
            <button 
              *ngIf="canCancelTransaction(transaction)"
              class="btn btn-danger btn-sm"
              (click)="cancelTransaction(transaction)">
              Cancelar
            </button>
            <button 
              class="btn btn-outline btn-sm"
              (click)="viewTransactionDetails(transaction)">
              Detalles
            </button>
          </div>
        </div>
      </div>

      <!-- Paginación -->
      <div *ngIf="!loading && transactions.length > 0" class="pagination-container">
        <div class="pagination-info">
          Mostrando {{ transactions.length }} de {{ totalTransactions }} transacciones
        </div>
        <div class="pagination">
          <button 
            class="btn btn-outline btn-sm"
            [disabled]="currentPage === 1"
            (click)="onPageChange(currentPage - 1)">
            Anterior
          </button>
          
          <span class="page-info">
            Página {{ currentPage }} de {{ getTotalPages() }}
          </span>
          
          <button 
            class="btn btn-outline btn-sm"
            [disabled]="currentPage === getTotalPages()"
            (click)="onPageChange(currentPage + 1)">
            Siguiente
          </button>
        </div>
      </div>
    </div>

  </div>
</div>